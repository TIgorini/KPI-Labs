// РІШЕННЯ ЗАДАЧІ PRODUCER-CONSUMER (СПІЛЬНИЙ РЕСУРС - ПРОСТА ЗМІННА)
// ЗА ДОПОМОГОЮ МОНІТОРА

class CommonResource
{
	int n;
	boolean valueSet = false;

	synchronized int get()
	{
		while (!valueSet)
			try
			{
				wait(); 
			}
			catch (InterruptedException e)
			{
				System.out.println("InterruptedException");
			}
			
		valueSet = false;
		notify();
			
		return n;
	}
	
	synchronized void put (int arg)
	{
		while (valueSet)
		
			try
			{
				wait();
			}
			catch (InterruptedException e)
			{
				System.out.println("InterruptedException");
			}
			
		n = arg;
		valueSet = true;
		notify();
		
	}
}

class Producer implements Runnable
{
	CommonResource CR;
		
	Producer (CommonResource CR_arg)
	{
		CR = CR_arg;
		new Thread (this, "Producer").start();
	}
	
	public void run()
	{
		int j = 0;
		while (true) 
		{
			CR.put(++j);
			System.out.println("Producer sended: " + j);
		}
	}
}
	
class Consumer implements Runnable
{
	CommonResource CR;
		
	Consumer (CommonResource CR_arg)
	{
		CR = CR_arg;
		new Thread (this, "Consumer").start();
	}
	
	public void run()
	{
		int current_n;
		while (true) 
		{
			current_n = CR.get();
			System.out.println("Consumer received: " + current_n);
		}
	}
}

class Main
{
	public static void main (String args[])
	{
		System.out.println ("To stop running press Ctrl+C");

		CommonResource MyCR = new CommonResource();
		new Producer ( MyCR );
		new Consumer ( MyCR );
		
	}
}
